(function(e){function t(t){for(var r,a,c=t[0],s=t[1],u=t[2],d=0,f=[];d<c.length;d++)a=c[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==i[s]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),i=n.n(r);i.a},"0970":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view",[n("div",{attrs:{id:"app"}})])},i=[];n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},"102b":function(e,t,n){"use strict";var r=n("28e2"),i=n.n(r);i.a},"199c":function(e,t){},"23be":function(e,t,n){"use strict";var r=n("199c"),i=n.n(r);t["default"]=i.a},"28e2":function(e,t,n){},"2fd5":function(e,t,n){"use strict";var r=n("33e0"),i=n.n(r);i.a},"33e0":function(e,t,n){},"3dfd":function(e,t,n){"use strict";var r=n("0970"),i=n("23be"),o=(n("034f"),n("2877")),a=Object(o["a"])(i["default"],r["a"],r["b"],!1,null,null,null);t["default"]=a.exports},"42eb":function(e,t,n){},"563f":function(e,t,n){"use strict";var r=n("7bd8"),i=n.n(r);i.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),i=n("3dfd"),o=n("8c4f"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"screen"},[n("div",{staticClass:"screen-header"},[n("Header")],1),n("div",{staticClass:"screen-content"},[n("router-view",{key:e.rendered})],1)])},c=[],s=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("div",{staticClass:"fluid-container"},[n("div",{staticClass:"logo"},[e._v("MarkdownBook")]),n("div",{staticClass:"nav"},[n("ul",[e.login===e.github.owner?["editor"===e.$route.name?[e.item.path?e._e():n("li",[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.path,expression:"path"}],attrs:{type:"search",placeholder:"文件名称"},domProps:{value:e.path},on:{input:function(t){t.target.composing||(e.path=t.target.value)}}}),e._v("\n                            .md\n                        ")])]),n("li",[n("a",{class:{disabled:!!e.processing,blink:"save"===e.processing},attrs:{href:"javascript:void(0)"},on:{click:e.saveItem}},[e._v("保存")])]),n("li",[n("a",{class:{disabled:!!e.processing},attrs:{href:"javascript:void(0)"},on:{click:e.discardItem}},[e._v("返回")])])]:[n("li",[n("a",{class:{disabled:!!e.processing},attrs:{href:"javascript:void(0)"},on:{click:e.newItem}},[e._v("新增")])]),e.item.path?[n("li",[n("a",{class:{disabled:!!e.processing},attrs:{href:"javascript:void(0)"},on:{click:e.editItem}},[e._v("修改")])]),n("li",[n("a",{class:{disabled:!!e.processing,blink:"remove"===e.processing},attrs:{href:"javascript:void(0)"},on:{click:e.removeItem}},[e._v("删除")])])]:e._e()]]:e._e(),n("li",[e.login?n("img",{staticClass:"avatar",attrs:{title:"@"+e.login+" 登出",alt:"@"+e.login,src:e.avatar},on:{click:function(t){return e.logout()}}}):e.token?e._e():n("a",{attrs:{href:"javascript:void(0)"},on:{click:[function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.goLogin(!1)},function(t){return t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:e.goLogin(!0):null}]}},[e._v("登录")])])],2)])])])},l=[],d=n("27ae"),f=n("d69d"),h=n.n(f),p="040ab84ddddee4c947c9f0f23a546464045f01ad",v={owner:"pnparadise",repo:"gitbook",publicToken:p,client:null,defaultClient:new h.a({auth:"token "+p})};function m(){if(!v.client){var e=sessionStorage.getItem("access_token");e&&(v.client=new h.a({auth:"token "+e}))}return new Promise((function(e,t){v.client?e(v.client):e(v.defaultClient)}))}var g={config:v,contents:function(e,t){return m().then((function(n){return n.repos.getContents({owner:v.owner,repo:v.repo,path:e,headers:{"If-None-Match":""},mediaType:{format:t||"html"}})}))},remove:function(e){return m().then((function(t){return t.repos.deleteFile({owner:v.owner,repo:v.repo,path:e.path,message:"octokit: [master] page deleted",sha:e.sha})}))},commit:function(e){return m().then((function(t){return t.repos.createOrUpdateFile({owner:v.owner,repo:v.repo,path:e.path,message:"octokit: [master] page modified",content:d["Base64"].encode(e.text),sha:e.sha})}))},user:function(){return m().then((function(e){return e.users.getAuthenticated()}))},grants:function(){return m().then((function(e){return e.oauthAuthorizations.listGrants()}))},encode:function(e){return d["Base64"].encodeURI(e)},decode:function(e){return d["Base64"].decode(e)},contentType:function(e){return"d"===e?"dir":"file"},location:function(e,t){return"/"+e.charAt(0)+"/"+this.encode(t)}},b=n("2f62");function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"Header",computed:w({},Object(b["c"])(["item","dir","token"])),data:function(){return{processing:!1,path:null,login:null,avatar:null,github:g.config}},mounted:function(){this.updateUser()},watch:{path:function(e,t){var n=this;/^\w*(\w+\/?){0,2}\w*$/.test(e)||this.$nextTick((function(){n.path=t}))},token:function(e,t){this.updateUser()},dir:function(e,t){this.path=e}},methods:w({},Object(b["b"])(["receiveItem","receiveToken","forceRender"]),{updateUser:function(){var e=this;this.token?g.user().then((function(t){e.login=t.data.login,e.avatar=t.data.avatar_url+"&s=32"})):(this.login=null,this.avatar=null)},goHome:function(e){return this.item.path&&"file"===this.item.type?this.$router.push(g.location(this.item.type,this.item.path),e):this.$router.push(g.location("dir",this.dir),e)},goLogin:function(e){return this.$router.push({name:"login",query:{me:e,redirectUrl:window.location.href}})},logout:function(){this.receiveToken(null),g.config.client=null},newItem:function(){return this.receiveItem({}),this.$router.push("/editor")},editItem:function(){return this.$router.push("/editor")},removeItem:function(){var e=this;this.processing||(this.processing="remove",g.remove(this.item).then((function(t){return e.receiveItem({}),e.goHome((function(){e.forceRender()}))})).finally((function(){e.processing=!1})))},saveItem:function(){var e=this;this.processing||(this.processing="save",this.item.path||(this.item.path=this.path+".md"),g.commit(this.item).then((function(t){return e.receiveItem(t.data.content),e.goHome()})).finally((function(){e.processing=!1})))},discardItem:function(){this.goHome()}})},O=k,j=(n("102b"),n("2877")),_=Object(j["a"])(O,u,l,!1,null,"282a1d6b",null),C=_.exports;function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D={name:"Home",components:{Header:C},computed:I({},Object(b["c"])(["rendered"]))},x=D,$=(n("2fd5"),Object(j["a"])(x,a,c,!1,null,"4c8f9eb5",null)),S=$.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}],staticClass:"editor-container"},[n("ul",{staticClass:"mirrormark-toolbar"},[n("li",{staticClass:"bold"},[n("a",{on:{click:function(t){return e.takeAction("bold")}}})]),n("li",{staticClass:"italicize"},[n("a",{on:{click:function(t){return e.takeAction("italicize")}}})]),n("li",{staticClass:"blockquote"},[n("a",{on:{click:function(t){return e.takeAction("blockquote")}}})]),n("li",{staticClass:"code"},[n("a",{on:{click:function(t){return e.takeAction("code")}}})]),n("li",{staticClass:"strikethrough"},[n("a",{on:{click:function(t){return e.takeAction("strikethrough")}}})]),n("li",{staticClass:"link"},[n("a",{on:{click:function(t){return e.takeAction("link")}}})]),n("li",{staticClass:"image"},[n("a",{on:{click:function(t){return e.takeAction("image")}}})]),n("li",{staticClass:"unorderedList"},[n("a",{on:{click:function(t){return e.takeAction("unorderedList")}}})]),n("li",{staticClass:"orderedList"},[n("a",{on:{click:function(t){return e.takeAction("orderedList")}}})]),n("li",{staticClass:"preview"},[n("a",{on:{click:function(t){return e.takeAction("preview")}}})])]),n("codemirror",{ref:"editor",attrs:{options:e.options,events:["drop"]},on:{drop:e.upload},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.preview,expression:"preview"}],staticClass:"editor-preview markdown-body",domProps:{innerHTML:e._s(e.markdown)}}),n("div",{staticClass:"fixed"},[n("a",{class:e.preview&&e.edit&&"active",attrs:{href:"#"},on:{click:function(t){return e.changeMode("all")}}},[e._v("Edit & Preview")]),n("a",{class:!e.preview&&e.edit&&"active",attrs:{href:"#"},on:{click:function(t){return e.changeMode("edit")}}},[e._v("Edit Only")]),n("a",{class:!e.edit&&e.preview&&"active",attrs:{href:"#"},on:{click:function(t){return e.changeMode("preview")}}},[e._v("Preview Only")])])])},E=[],T=(n("8449"),n("55dd"),n("7f7f"),n("8f94")),M=(n("959b"),n("44a0"),n("9f09"),n("9eb9"),n("0e54")),L=n.n(M),R=n("c197"),U=n.n(R);n("19fe"),n("43bf");function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(n,!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}L.a.setOptions({renderer:new L.a.Renderer,highlight:function(e,t,n){var r=U.a.languages[t]||U.a.languages.autoit;return U.a.highlight(e,r)},gfm:!0,breaks:!1});var B={name:"editor",components:{codemirror:T["codemirror"]},computed:H({},Object(b["c"])(["item"])),data:function(){return{editorHeight:0,edit:!0,preview:!0,markdown:null,content:null,editor:null,options:{tabSize:4,mode:"text/x-gfm",lineNumbers:!0,line:!0,lineWrapping:!0,theme:"mirrormark",viewportMargin:1/0}}},watch:{content:function(e,t){this.markdown=L()(e),this.item.text=e,this.receiveItem(this.item)}},mounted:function(){var e=this;this.editor=this.$refs.editor.codemirror,this.item.path&&g.contents(this.item.path,"raw").then((function(t){return e.content=t.data,t}))},methods:H({},Object(b["b"])(["receiveItem"]),{changeMode:function(e){e&&"edit"===e?(this.edit=!0,this.preview=!1):e&&"preview"===e?(this.edit=!1,this.preview=!0):(this.edit=!0,this.preview=!0)},upload:function(e,t){if(console.info(e,t),/image\/.+$/.test(t.dataTransfer.files[0].type)){this.text="!["+t.dataTransfer.files[0].name+"]("+t.dataTransfer.files[0].webkitRelativePath+")";var n=e.coordsChar({left:t.x,top:t.y});e.replaceRange(this.text,n)}},insert:function(e){var t=this.editor.getDoc(),n=t.getCursor();t.replaceRange(e,{line:n.line,ch:n.ch})},insertAround:function(e,t){var n=this.editor.getDoc(),r=n.getCursor();if(n.somethingSelected()){var i=n.getSelection();n.replaceSelection(e+i+t)}else n.replaceRange(e+t,{line:r.line,ch:r.ch}),n.setCursor({line:r.line,ch:r.ch+e.length})},insertBefore:function(e,t){var n=this.editor.getDoc(),r=n.getCursor();if(n.somethingSelected()){var i=n.listSelections();i.forEach((function(r){for(var i=[r.head.line,r.anchor.line].sort(),o=i[0];o<=i[1];o++)n.replaceRange(e,{line:o,ch:0});n.setCursor({line:i[0],ch:t||0})}))}else n.replaceRange(e,{line:r.line,ch:0}),n.setCursor({line:r.line,ch:t||0})},takeAction:function(e){switch(e){case"bold":this.insertAround("**","**");break;case"italicize":this.insertAround("*","*");break;case"strikethrough":this.insertAround("~~","~~");break;case"code":this.insertAround("```\r\n","\r\n```");break;case"blockquote":this.insertBefore("> ",2);break;case"orderedList":this.insertBefore("1. ",3);break;case"unorderedList":this.insertBefore("* ",2);break;case"image":this.insertBefore("![](http://)",2);break;case"link":this.insertAround("[","](http://)");break;case"hr":this.insert("---");break}}})},q=B,K=(n("fb2f"),Object(j["a"])(q,A,E,!1,null,"3a93ce17",null)),N=K.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fluid-container"},[n("div",{staticClass:"panel entry-list"},[n("ul",{staticClass:"entry-box"},[n("li",{staticClass:"entry",class:{active:e.loading&&!1===e.items,disabled:""===e.dir},on:{click:function(t){return e.parentDir()}}},[n("div",{staticClass:"entry-body"},[e.loading&&!1===e.items?n("div",{staticClass:"entry-indicator"},[n("Loading")],1):e._e(),e._v("\n                    返回上层\n                ")]),n("div",{staticClass:"entry-footer"},[e._v("\n                    "+e._s(e.dir||"..."))])]),e._l(e.items,(function(t){return n("li",{staticClass:"entry",class:{active:t.path===e.item.path},on:{click:function(n){return e.processItem(t)}}},[n("div",{staticClass:"entry-body"},[e.loading&&t.path===e.item.path?n("div",{staticClass:"entry-indicator"},[n("Loading")],1):e._e(),e._v("\n                    "+e._s(t.name)+"\n                ")]),"file"===t.type?n("div",{staticClass:"entry-footer"},[e._v(e._s(t.size)+" byte")]):e._e(),"dir"===t.type?n("div",{staticClass:"entry-footer"},[e._v("目录")]):e._e()])}))],2)]),n("div",{staticClass:"panel markdown-body"},[n("div",{domProps:{innerHTML:e._s(e.preview)}})])])},J=[],G=(n("4917"),n("a481"),n("7514"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loader simple-circle"})}),W=[],Q={name:"Loading"},V=Q,X=(n("cf86"),Object(j["a"])(V,G,W,!1,null,"73480762",null)),Y=X.exports;function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(n,!0).forEach((function(t){Object(s["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te={name:"Entry",components:{Loading:Y},data:function(){return{loading:0,items:!1,preview:null}},computed:ee({},Object(b["c"])(["dir","item"])),created:function(){},beforeDestroy:function(){},mounted:function(){var e=this,t={type:"dir",path:""},n=this.$route.query.access_token;n||(n=sessionStorage.getItem("access_token")),n&&this.receiveToken(n);var r=this.$route.params.prefix,i=this.$route.params.hash;if(r&&i&&(t.type=g.contentType(r),t.path=g.decode(i)),this.processItem(t).then((function(t){if(e.$route.hash){var n=document.querySelector("[href='"+decodeURIComponent(e.$route.hash)+"']");if(n){var r=50,i=n.getBoundingClientRect().top,o=i-r;window.scrollTo({top:o,behavior:"smooth"})}}})),"file"===t.type){this.loading++;var o=this.findDir(t.path);return this.receiveDir(o),this.showDir(o).then((function(n){return e.receiveItem(e.items.find((function(e){return e.path===t.path}))),n})).finally((function(){e.loading--}))}},methods:ee({},Object(b["b"])(["receiveItem","receiveDir","receiveToken"]),{findDir:function(e){return e.replace(/\/?[^/]*$/,"")},parentDir:function(){var e=this.dir.match("[^/]+(/[^/]*)?$");e&&this.processItem({type:"dir",path:this.dir.slice(0,this.dir.length-e[0].length)})},processItem:function(e){var t=this;if(!this.loading){this.loading++;var n=g.location(e.type,e.path);return n!==this.$route.path&&this.$router.replace(n),"dir"===e.type?(this.receiveItem({}),this.receiveDir(e.path),this.showDir(e.path).finally((function(){t.loading--}))):(this.receiveItem(e),this.showFile(e.path).finally((function(){t.loading--})))}},showDir:function(e){var t=this;return this.items=!1,g.contents(e).then((function(e){return t.items=e.data,e}))},showFile:function(e){var t=this;return g.contents(e).then((function(e){return t.preview=e.data,e}))}})},ne=te,re=(n("563f"),Object(j["a"])(ne,F,J,!1,null,"031c2982",null)),ie=re.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},ae=[],ce={name:"Login",mounted:function(){if(this.$route.query.me){var e="client_id=225031944a6bf76a419c";window.location="https://github.com/login/oauth/authorize?"+e+"&redirect_uri="+encodeURIComponent(this.authorizeUrl(e))+"&scope=repo&login="+g.config.owner+"&state="+Math.floor(1e5*Math.random())}else{var t="client_id=Iv1.fb87a658b1a64609";window.location="https://github.com/login/oauth/authorize?"+t+"&redirect_uri="+encodeURIComponent(this.authorizeUrl(t))+"&state="+Math.floor(1e5*Math.random())}},methods:{authorizeUrl:function(e){return"http://nonwa11.xyz:8443/github.php?"+e+"&redirect_uri="+encodeURIComponent(this.$route.query.redirectUrl||"")}}},se=ce,ue=Object(j["a"])(se,oe,ae,!1,null,"32b784ac",null),le=ue.exports;r["a"].use(o["a"]);var de=new o["a"]({mode:"history",base:"/",routes:[{path:"/",component:S,children:[{name:"home",path:"/",component:ie},{path:"/editor",component:N,name:"editor"},{name:"entry",path:"/:prefix([f|d]?)/:hash?",component:ie},{name:"login",path:"/login",component:le}]}]});r["a"].use(b["a"]);var fe={rendered:0,item:{},dir:"",token:null},he={receiveItem:function(e,t){e.item=t},receiveDir:function(e,t){e.dir=t},receiveToken:function(e,t){t?sessionStorage.setItem("access_token",t):sessionStorage.removeItem("access_token"),e.token=t},forceRender:function(e,t){e.rendered++}},pe={},ve=new b["a"].Store({state:fe,mutations:he,actions:pe});r["a"].config.productionTip=!1,new r["a"]({router:de,store:ve,render:function(e){return e(i["default"])}}).$mount("#app")},"64a9":function(e,t,n){},"7bd8":function(e,t,n){},c8f2:function(e,t,n){},cf86:function(e,t,n){"use strict";var r=n("42eb"),i=n.n(r);i.a},fb2f:function(e,t,n){"use strict";var r=n("c8f2"),i=n.n(r);i.a}});
//# sourceMappingURL=app.b619de61.js.map